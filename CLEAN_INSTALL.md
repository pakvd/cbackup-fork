# üßπ –ü–æ–ª–Ω–∞—è —á–∏—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª–Ω–æ–π —á–∏—Å—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ cBackup —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose.

## –ß—Ç–æ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –¥–ª—è —á–∏—Å—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

1. **Docker volumes** (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, runtime, redis)
2. **–§–∞–π–ª—ã install.lock** (–ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
3. **–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø—Ä–∞–≤):

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose down

# 2. –£–¥–∞–ª–∏—Ç—å –í–°–ï volumes (—ç—Ç–æ —É–¥–∞–ª–∏—Ç –ë–î –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
docker compose down -v

# 3. –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã install.lock (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ)
rm -f ./core/install.lock ./core/runtime/install.lock

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
make set-permissions
# –∏–ª–∏
./set-permissions.sh

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º)
make up
# –∏–ª–∏
./docker-compose-up.sh up -d

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –æ—Ç–∫—Ä—ã–ª—Å—è
# –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:8080
```

## üìã –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π):

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose down

# 2. –£–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ volumes –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker volume rm cbackup-fork_db_data

# 3. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–¥–∞–ª–∏—Ç—å –¥—Ä—É–≥–∏–µ volumes
docker volume rm cbackup-fork_web_runtime  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
docker volume rm cbackup-fork_redis_data   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

# 4. –£–¥–∞–ª–∏—Ç—å install.lock
rm -f ./core/install.lock ./core/runtime/install.lock

# 5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
make set-permissions

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
make up
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make status
# –∏–ª–∏
docker compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
make logs
# –∏–ª–∏
docker compose logs -f

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:8080 (–∏–ª–∏ –≤–∞—à IP:8080)
```

–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –º–∞—Å—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cBackup.

## üì¶ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏:
- `backup` - –∑–∞–¥–∞—á–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- `discovery` - –∑–∞–¥–∞—á–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `stp` - —Å–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ STP (Spanning Tree Protocol)
- `save` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- `git_commit` - –∫–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- `log_processing` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–≥–æ–≤
- `node_processing` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–∑–ª–æ–≤ —Å–µ—Ç–∏

### –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç (—Ä–µ–¥–∫–æ):

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –°–ø–æ—Å–æ–± 1: –ò—Å–ø–æ–ª—å–∑—É—è —Å–∫—Ä–∏–ø—Ç (–µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
docker compose exec web php /var/www/html/add_default_tasks.php

# –°–ø–æ—Å–æ–± 2: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ MySQL CLI
docker compose exec db mysql -u cbackup -pcbackup_password cbackup << EOF
INSERT IGNORE INTO \`task\` (\`name\`, \`task_type\`, \`put\`, \`table\`, \`protected\`, \`description\`) VALUES
('backup', 'backup', 'database', 'out_backup', 1, 'Backup task - stores configuration backups in database'),
('discovery', 'discovery', NULL, NULL, 1, 'Discovery task - automatically discovers network devices'),
('stp', 'custom', 'database', 'out_stp', 1, 'STP information collection task'),
('save', 'custom', 'file', NULL, 1, 'Save task - saves configurations to file system'),
('git_commit', 'custom', 'git', NULL, 1, 'Git commit task - commits changes to Git repository'),
('log_processing', 'custom', NULL, NULL, 1, 'Log processing task'),
('node_processing', 'custom', NULL, NULL, 1, 'Node processing task');
EOF
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:

### –ü—Ä–æ–±–ª–µ–º–∞: –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ web –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker compose logs web | tail -50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ install.lock
docker compose exec web ls -la /var/www/html/install.lock
docker compose exec web ls -la /var/www/html/runtime/install.lock

# –ï—Å–ª–∏ install.lock —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É–¥–∞–ª–∏—Ç—å –µ–≥–æ
docker compose exec web rm -f /var/www/html/install.lock /var/www/html/runtime/install.lock
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ö–æ—Å—Ç–µ
make set-permissions
# –∏–ª–∏ —Å sudo, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo ./set-permissions.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose restart web
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker compose logs db | tail -50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ë–î –∑–∞–ø—É—â–µ–Ω
docker compose ps db

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å volumes
docker compose down -v
docker compose up -d db
```

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. **–ü—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make up` –∏–ª–∏ `./docker-compose-up.sh up -d` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –Ω–∞ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

2. **–ü–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 
   - MySQL –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `cbackup`
   - MySQL –ø–∞—Ä–æ–ª—å: `cbackup_password` (–∏–∑–º–µ–Ω–∏—Ç–µ –≤ `.env` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!)
   - MySQL root –ø–∞—Ä–æ–ª—å: `root_secure_2024` (–∏–∑–º–µ–Ω–∏—Ç–µ –≤ `.env`!)

3. **–ü–æ—Ä—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**:
   - Web: `8080`
   - MySQL: –Ω–µ –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞ —Ö–æ—Å—Ç (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

4. **Volume mounts**: –§–∞–π–ª—ã –≤ `./core` –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø–æ—ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Ö–æ—Å—Ç–µ —Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–æ—Å–ª–µ —á–∏—Å—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω)
git clone <repository-url>
cd cbackup-fork

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# 3. –ü–æ–ª–Ω–∞—è —á–∏—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down -v
rm -f ./core/install.lock ./core/runtime/install.lock
make up

# 4. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:8080
```

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:

- **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**: –°–º. `QUICKSTART.md`
- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**: –°–º. `PRODUCTION_READY.md` –∏–ª–∏ `SERVER_PREPARATION.md`
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°–º. `SECURITY_SUMMARY.md`

